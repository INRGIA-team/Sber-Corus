2022-09-21T11:39:35.783842+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T11:39:35.783842+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T11:39:35.803896+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T11:39:35.803896+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T11:41:31.427444+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T11:41:31.427444+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T11:41:31.443525+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T11:41:31.443525+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:39:04.709562+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:39:04.709562+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:39:04.725307+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:39:04.725307+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:39:07.114980+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T13:39:07.114980+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T13:39:07.366660+0000: INFO|	 GET /api/car/3/ 200 OK
2022-09-21T13:39:07.366660+0000: INFO|	 GET /api/car/3/ 200 OK
2022-09-21T13:39:07.393491+0000: INFO|	 GET /api/car/3/ 200 OK
2022-09-21T13:39:07.393491+0000: INFO|	 GET /api/car/3/ 200 OK
2022-09-21T13:39:11.943093+0000: INFO|	 UPDATE /api/car/{ id : 3, car_number : 13123, model : 123123, owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T13:39:11.943093+0000: INFO|	 UPDATE /api/car/{ id : 3, car_number : 13123, model : 123123, owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T13:39:13.278806+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:39:13.278806+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:39:13.294994+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:39:13.294994+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:51:24.990213+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:51:24.990213+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:51:25.008162+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:51:25.008162+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:51:27.594551+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T13:51:27.594551+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T13:51:27.649994+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T13:51:27.649994+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T13:51:27.701724+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T13:51:27.701724+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T13:51:31.401115+0000: INFO|	 UPDATE /api/car/{ id : 4, car_number : 124, model : 4214, owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T13:51:31.401115+0000: INFO|	 UPDATE /api/car/{ id : 4, car_number : 124, model : 4214, owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T13:51:32.343714+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:51:32.343714+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:51:32.355650+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T13:51:32.355650+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:28:38.224894+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:28:38.224894+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:28:38.244704+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:28:38.244704+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:29:10.019225+0000: INFO|	 GET /api/car/1/ 200 OK
2022-09-21T14:29:10.019225+0000: INFO|	 GET /api/car/1/ 200 OK
2022-09-21T14:29:10.030752+0000: INFO|	 GET /api/car/1/ 200 OK
2022-09-21T14:29:10.030752+0000: INFO|	 GET /api/car/1/ 200 OK
2022-09-21T14:33:56.971987+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:33:56.971987+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:33:56.980991+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:33:56.980991+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:34:24.453056+0000: INFO|	 POST /api/car/ { car_number : 1241, model : string, owner : string, odometer : 0.0, picture : string } 200 OK
2022-09-21T14:34:24.453056+0000: INFO|	 POST /api/car/ { car_number : 1241, model : string, owner : string, odometer : 0.0, picture : string } 200 OK
2022-09-21T14:34:29.234964+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:34:29.234964+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:34:29.249137+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:34:29.249137+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:35:09.926368+0000: INFO|	 POST /api/car/ { car_number : 34134, model : string, owner : string, odometer : 0.0, picture : string } 200 OK
2022-09-21T14:35:09.926368+0000: INFO|	 POST /api/car/ { car_number : 34134, model : string, owner : string, odometer : 0.0, picture : string } 200 OK
2022-09-21T14:35:14.461100+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:35:14.461100+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:35:14.475918+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:35:14.475918+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:40:24.946282+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:40:24.946282+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:40:24.972138+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:40:24.972138+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:40:27.473313+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T14:40:27.473313+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T14:40:27.524307+0000: INFO|	 GET /api/car/5/ 200 OK
2022-09-21T14:40:27.524307+0000: INFO|	 GET /api/car/5/ 200 OK
2022-09-21T14:40:27.570406+0000: INFO|	 GET /api/car/5/ 200 OK
2022-09-21T14:40:27.570406+0000: INFO|	 GET /api/car/5/ 200 OK
2022-09-21T14:40:31.740588+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140446663046976):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2430>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 5}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a46d0; closed: -1>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 159, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7fbc495689d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7fbc47e9ae50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7fbc47e9a940>
    └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fbc47e9a9d0>
           │       │   └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
           │       └ <function run at 0x7fbc494749d0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7fbc44918340>
           │    └ <function BaseEventLoop.run_until_complete at 0x7fbc48dd10d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7fbc48dd1040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7fbc48dd2b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7fbc48e07820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4479a580>(<Future finis...7fbc4488edc0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4479a580>(<Future finis...7fbc4488edc0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4479a580>(<Future finis...7fbc4488edc0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4479a580>(<Future finis...7fbc4488edc0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
          └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc447594c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc447594c0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7fbc47f6b160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc447c6820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc447c6820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7fbc4474ec10>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc447c6820>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7fbc48077280>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc447c6820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7fbc448a20d0>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fbc4488e7c0>
                     └ <function get_request_handler.<locals>.app at 0x7fbc448a2040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fbc48065160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7fbc4488edc0>, 'car_data': UpdateCar(id=5, car_number='13123', model='', o...
                 │         └ <function update_car at 0x7fbc448b0f70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7fbc448a8310>

  File "/app/fastapi_service/main.py", line 152, in update_car
    car = await _services.update_car(car_data=car_data, car=car, db=db)
                │         │                   │             │       └ <sqlalchemy.orm.session.Session object at 0x7fbc4488edc0>
                │         │                   │             └ <models.Car object at 0x7fbc436c52e0>
                │         │                   └ UpdateCar(id=5, car_number='13123', model='', owner='0', odometer=0.0, picture=None)
                │         └ <function update_car at 0x7fbc46dcef70>
                └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 87, in update_car
    db.commit()
    │  └ <function Session.commit at 0x7fbc46ff0310>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc4488edc0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
    │    │            │               │    └ False
    │    │            │               └ <sqlalchemy.orm.session.Session object at 0x7fbc4488edc0>
    │    │            └ <function SessionTransaction.commit at 0x7fbc46fed280>
    │    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43711670>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc4488edc0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x7fbc46fed1f0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43711670>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x7fbc46feff70>
    │    └ <sqlalchemy.orm.session.Session object at 0x7fbc4488edc0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43711670>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3386, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7fbc46ff3160>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc4488edc0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3526, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x7fbc46fed310>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc437114f0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util.compat' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3486, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7fbc46fe5940>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc4479a7f0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc4479a7f0>
    │   └ <function SaveUpdateAll.execute at 0x7fbc46fe7280>
    └ SaveUpdateAll(mapped class Car->car)
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x7fbc46fd73a0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py'>
    │    └ <sqlalchemy.util._preloaded._ModuleRegistry object at 0x7fbc47e5c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 237, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x7fbc46fd7940>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 1001, in _emit_update_statements
    c = connection._execute_20(
        │          └ <function Connection._execute_20 at 0x7fbc4754bf70>
        └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2430>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ {'compiled_cache': {(<sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>, ('0', <class 'sql...
           │    │     │             └ immutabledict({})
           │    │     └ ([{'car_number': '13123', 'car_id': 5}],)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2430>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x7fbc437112e0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fbc4754bdc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2430>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fbc4754c0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2430>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fbc4754c280>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2430>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2430>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 5}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a46d0; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.

[SQL: UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s]
[parameters: {'car_number': '13123', 'car_id': 5}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-09-21T14:40:31.740588+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140446663046976):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2430>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 5}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a46d0; closed: -1>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 159, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7fbc495689d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7fbc47e9ae50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7fbc47e9a940>
    └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fbc47e9a9d0>
           │       │   └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
           │       └ <function run at 0x7fbc494749d0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7fbc44918340>
           │    └ <function BaseEventLoop.run_until_complete at 0x7fbc48dd10d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7fbc48dd1040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7fbc48dd2b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7fbc48e07820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4479a580>(<Future finis...7fbc4488edc0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4479a580>(<Future finis...7fbc4488edc0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4479a580>(<Future finis...7fbc4488edc0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4479a580>(<Future finis...7fbc4488edc0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
          └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc447594c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc447594c0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7fbc47f6b160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc447c6820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc447c6820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7fbc4474ec10>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc447c6820>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7fbc48077280>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc447c6820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc436c55e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7fbc448a20d0>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fbc4488e7c0>
                     └ <function get_request_handler.<locals>.app at 0x7fbc448a2040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fbc48065160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7fbc4488edc0>, 'car_data': UpdateCar(id=5, car_number='13123', model='', o...
                 │         └ <function update_car at 0x7fbc448b0f70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7fbc448a8310>

  File "/app/fastapi_service/main.py", line 152, in update_car
    car = await _services.update_car(car_data=car_data, car=car, db=db)
                │         │                   │             │       └ <sqlalchemy.orm.session.Session object at 0x7fbc4488edc0>
                │         │                   │             └ <models.Car object at 0x7fbc436c52e0>
                │         │                   └ UpdateCar(id=5, car_number='13123', model='', owner='0', odometer=0.0, picture=None)
                │         └ <function update_car at 0x7fbc46dcef70>
                └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 87, in update_car
    db.commit()
    │  └ <function Session.commit at 0x7fbc46ff0310>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc4488edc0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
    │    │            │               │    └ False
    │    │            │               └ <sqlalchemy.orm.session.Session object at 0x7fbc4488edc0>
    │    │            └ <function SessionTransaction.commit at 0x7fbc46fed280>
    │    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43711670>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc4488edc0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x7fbc46fed1f0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43711670>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x7fbc46feff70>
    │    └ <sqlalchemy.orm.session.Session object at 0x7fbc4488edc0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43711670>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3386, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7fbc46ff3160>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc4488edc0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3526, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x7fbc46fed310>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc437114f0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util.compat' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3486, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7fbc46fe5940>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc4479a7f0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc4479a7f0>
    │   └ <function SaveUpdateAll.execute at 0x7fbc46fe7280>
    └ SaveUpdateAll(mapped class Car->car)
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x7fbc46fd73a0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py'>
    │    └ <sqlalchemy.util._preloaded._ModuleRegistry object at 0x7fbc47e5c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 237, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x7fbc46fd7940>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 1001, in _emit_update_statements
    c = connection._execute_20(
        │          └ <function Connection._execute_20 at 0x7fbc4754bf70>
        └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2430>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ {'compiled_cache': {(<sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>, ('0', <class 'sql...
           │    │     │             └ immutabledict({})
           │    │     └ ([{'car_number': '13123', 'car_id': 5}],)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2430>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x7fbc437112e0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fbc4754bdc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2430>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fbc4754c0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2430>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fbc4754c280>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2430>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2430>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 5}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a46d0; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.

[SQL: UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s]
[parameters: {'car_number': '13123', 'car_id': 5}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-09-21T14:40:33.524967+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140446663046976):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2be0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 5}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4a90; closed: -1>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 159, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7fbc495689d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7fbc47e9ae50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7fbc47e9a940>
    └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fbc47e9a9d0>
           │       │   └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
           │       └ <function run at 0x7fbc494749d0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7fbc44918340>
           │    └ <function BaseEventLoop.run_until_complete at 0x7fbc48dd10d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7fbc48dd1040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7fbc48dd2b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7fbc48e07820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4488e190>(<Future finis...7fbc447b83d0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4488e190>(<Future finis...7fbc447b83d0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4488e190>(<Future finis...7fbc447b83d0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4488e190>(<Future finis...7fbc447b83d0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
          └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc448004c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc448004c0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7fbc47f6b160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7fbc4474ec10>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7fbc48077280>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7fbc448a20d0>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fbc436c5f70>
                     └ <function get_request_handler.<locals>.app at 0x7fbc448a2040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fbc48065160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7fbc447b83d0>, 'car_data': UpdateCar(id=5, car_number='13123', model='', o...
                 │         └ <function update_car at 0x7fbc448b0f70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7fbc448a8310>

  File "/app/fastapi_service/main.py", line 152, in update_car
    car = await _services.update_car(car_data=car_data, car=car, db=db)
                │         │                   │             │       └ <sqlalchemy.orm.session.Session object at 0x7fbc447b83d0>
                │         │                   │             └ <models.Car object at 0x7fbc43448520>
                │         │                   └ UpdateCar(id=5, car_number='13123', model='', owner='0', odometer=0.0, picture=None)
                │         └ <function update_car at 0x7fbc46dcef70>
                └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 87, in update_car
    db.commit()
    │  └ <function Session.commit at 0x7fbc46ff0310>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc447b83d0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
    │    │            │               │    └ False
    │    │            │               └ <sqlalchemy.orm.session.Session object at 0x7fbc447b83d0>
    │    │            └ <function SessionTransaction.commit at 0x7fbc46fed280>
    │    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc436f20d0>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc447b83d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x7fbc46fed1f0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc436f20d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x7fbc46feff70>
    │    └ <sqlalchemy.orm.session.Session object at 0x7fbc447b83d0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc436f20d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3386, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7fbc46ff3160>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc447b83d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3526, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x7fbc46fed310>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc436f21f0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util.compat' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3486, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7fbc46fe5940>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc436c52b0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc436c52b0>
    │   └ <function SaveUpdateAll.execute at 0x7fbc46fe7280>
    └ SaveUpdateAll(mapped class Car->car)
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x7fbc46fd73a0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py'>
    │    └ <sqlalchemy.util._preloaded._ModuleRegistry object at 0x7fbc47e5c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 237, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x7fbc46fd7940>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 1001, in _emit_update_statements
    c = connection._execute_20(
        │          └ <function Connection._execute_20 at 0x7fbc4754bf70>
        └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2be0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ {'compiled_cache': {(<sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>, ('0', <class 'sql...
           │    │     │             └ immutabledict({})
           │    │     └ ([{'car_number': '13123', 'car_id': 5}],)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2be0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x7fbc437112e0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fbc4754bdc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2be0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fbc4754c0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2be0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fbc4754c280>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2be0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2be0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 5}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4a90; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.

[SQL: UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s]
[parameters: {'car_number': '13123', 'car_id': 5}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-09-21T14:40:33.524967+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140446663046976):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2be0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 5}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4a90; closed: -1>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 159, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7fbc495689d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7fbc47e9ae50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7fbc47e9a940>
    └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fbc47e9a9d0>
           │       │   └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
           │       └ <function run at 0x7fbc494749d0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7fbc44918340>
           │    └ <function BaseEventLoop.run_until_complete at 0x7fbc48dd10d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7fbc48dd1040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7fbc48dd2b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7fbc48e07820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4488e190>(<Future finis...7fbc447b83d0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4488e190>(<Future finis...7fbc447b83d0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4488e190>(<Future finis...7fbc447b83d0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc4488e190>(<Future finis...7fbc447b83d0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
          └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc448004c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc448004c0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7fbc47f6b160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7fbc4474ec10>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7fbc48077280>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434483d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7fbc448a20d0>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fbc436c5f70>
                     └ <function get_request_handler.<locals>.app at 0x7fbc448a2040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fbc48065160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7fbc447b83d0>, 'car_data': UpdateCar(id=5, car_number='13123', model='', o...
                 │         └ <function update_car at 0x7fbc448b0f70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7fbc448a8310>

  File "/app/fastapi_service/main.py", line 152, in update_car
    car = await _services.update_car(car_data=car_data, car=car, db=db)
                │         │                   │             │       └ <sqlalchemy.orm.session.Session object at 0x7fbc447b83d0>
                │         │                   │             └ <models.Car object at 0x7fbc43448520>
                │         │                   └ UpdateCar(id=5, car_number='13123', model='', owner='0', odometer=0.0, picture=None)
                │         └ <function update_car at 0x7fbc46dcef70>
                └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 87, in update_car
    db.commit()
    │  └ <function Session.commit at 0x7fbc46ff0310>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc447b83d0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
    │    │            │               │    └ False
    │    │            │               └ <sqlalchemy.orm.session.Session object at 0x7fbc447b83d0>
    │    │            └ <function SessionTransaction.commit at 0x7fbc46fed280>
    │    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc436f20d0>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc447b83d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x7fbc46fed1f0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc436f20d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x7fbc46feff70>
    │    └ <sqlalchemy.orm.session.Session object at 0x7fbc447b83d0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc436f20d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3386, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7fbc46ff3160>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc447b83d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3526, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x7fbc46fed310>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc436f21f0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util.compat' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3486, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7fbc46fe5940>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc436c52b0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc436c52b0>
    │   └ <function SaveUpdateAll.execute at 0x7fbc46fe7280>
    └ SaveUpdateAll(mapped class Car->car)
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x7fbc46fd73a0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py'>
    │    └ <sqlalchemy.util._preloaded._ModuleRegistry object at 0x7fbc47e5c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 237, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x7fbc46fd7940>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 1001, in _emit_update_statements
    c = connection._execute_20(
        │          └ <function Connection._execute_20 at 0x7fbc4754bf70>
        └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2be0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ {'compiled_cache': {(<sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>, ('0', <class 'sql...
           │    │     │             └ immutabledict({})
           │    │     └ ([{'car_number': '13123', 'car_id': 5}],)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2be0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x7fbc437112e0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fbc4754bdc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2be0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fbc4754c0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2be0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fbc4754c280>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2be0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc436f2be0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 5}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4a90; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.

[SQL: UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s]
[parameters: {'car_number': '13123', 'car_id': 5}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-09-21T14:40:36.780995+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140446663046976):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43448fd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'model': '123', 'car_id': 5}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s, model=%(model)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4a90; closed: -1>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 159, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7fbc495689d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7fbc47e9ae50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7fbc47e9a940>
    └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fbc47e9a9d0>
           │       │   └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
           │       └ <function run at 0x7fbc494749d0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7fbc44918340>
           │    └ <function BaseEventLoop.run_until_complete at 0x7fbc48dd10d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7fbc48dd1040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7fbc48dd2b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7fbc48e07820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434487f0>(<Future finis...7fbc436c50a0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434487f0>(<Future finis...7fbc436c50a0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434487f0>(<Future finis...7fbc436c50a0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434487f0>(<Future finis...7fbc436c50a0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
          └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc4344e430>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc4344e430>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7fbc47f6b160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344e0d0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344e0d0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7fbc4474ec10>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344e0d0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7fbc48077280>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344e0d0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7fbc448a20d0>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fbc434487c0>
                     └ <function get_request_handler.<locals>.app at 0x7fbc448a2040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fbc48065160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7fbc436c50a0>, 'car_data': UpdateCar(id=5, car_number='13123', model='123'...
                 │         └ <function update_car at 0x7fbc448b0f70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7fbc448a8310>

  File "/app/fastapi_service/main.py", line 152, in update_car
    car = await _services.update_car(car_data=car_data, car=car, db=db)
                │         │                   │             │       └ <sqlalchemy.orm.session.Session object at 0x7fbc436c50a0>
                │         │                   │             └ <models.Car object at 0x7fbc43448ee0>
                │         │                   └ UpdateCar(id=5, car_number='13123', model='123', owner='0', odometer=0.0, picture=None)
                │         └ <function update_car at 0x7fbc46dcef70>
                └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 87, in update_car
    db.commit()
    │  └ <function Session.commit at 0x7fbc46ff0310>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc436c50a0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
    │    │            │               │    └ False
    │    │            │               └ <sqlalchemy.orm.session.Session object at 0x7fbc436c50a0>
    │    │            └ <function SessionTransaction.commit at 0x7fbc46fed280>
    │    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc447b0700>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc436c50a0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x7fbc46fed1f0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc447b0700>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x7fbc46feff70>
    │    └ <sqlalchemy.orm.session.Session object at 0x7fbc436c50a0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc447b0700>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3386, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7fbc46ff3160>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc436c50a0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3526, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x7fbc46fed310>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43448e80>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util.compat' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3486, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7fbc46fe5940>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc434489a0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc434489a0>
    │   └ <function SaveUpdateAll.execute at 0x7fbc46fe7280>
    └ SaveUpdateAll(mapped class Car->car)
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x7fbc46fd73a0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py'>
    │    └ <sqlalchemy.util._preloaded._ModuleRegistry object at 0x7fbc47e5c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 237, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x7fbc46fd7940>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 1001, in _emit_update_statements
    c = connection._execute_20(
        │          └ <function Connection._execute_20 at 0x7fbc4754bf70>
        └ <sqlalchemy.engine.base.Connection object at 0x7fbc43448fd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ {'compiled_cache': {(<sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>, ('0', <class 'sql...
           │    │     │             └ immutabledict({})
           │    │     └ ([{'car_number': '13123', 'model': '123', 'car_id': 5}],)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43448fd0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x7fbc437112e0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fbc4754bdc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fbc43448fd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fbc4754c0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fbc43448fd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fbc4754c280>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43448fd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43448fd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'model': '123', 'car_id': 5}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s, model=%(model)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4a90; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.

[SQL: UPDATE car SET car_number=%(car_number)s, model=%(model)s WHERE car.id = %(car_id)s]
[parameters: {'car_number': '13123', 'model': '123', 'car_id': 5}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-09-21T14:40:36.780995+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140446663046976):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43448fd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'model': '123', 'car_id': 5}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s, model=%(model)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4a90; closed: -1>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 159, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7fbc495689d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7fbc47e9ae50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7fbc47e9a940>
    └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fbc47e9a9d0>
           │       │   └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
           │       └ <function run at 0x7fbc494749d0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7fbc44918340>
           │    └ <function BaseEventLoop.run_until_complete at 0x7fbc48dd10d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7fbc48dd1040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7fbc48dd2b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7fbc48e07820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434487f0>(<Future finis...7fbc436c50a0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434487f0>(<Future finis...7fbc436c50a0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434487f0>(<Future finis...7fbc436c50a0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434487f0>(<Future finis...7fbc436c50a0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
          └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc4344e430>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc4344e430>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7fbc47f6b160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344e0d0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344e0d0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7fbc4474ec10>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344e0d0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7fbc48077280>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344e0d0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434534f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7fbc448a20d0>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fbc434487c0>
                     └ <function get_request_handler.<locals>.app at 0x7fbc448a2040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fbc48065160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7fbc436c50a0>, 'car_data': UpdateCar(id=5, car_number='13123', model='123'...
                 │         └ <function update_car at 0x7fbc448b0f70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7fbc448a8310>

  File "/app/fastapi_service/main.py", line 152, in update_car
    car = await _services.update_car(car_data=car_data, car=car, db=db)
                │         │                   │             │       └ <sqlalchemy.orm.session.Session object at 0x7fbc436c50a0>
                │         │                   │             └ <models.Car object at 0x7fbc43448ee0>
                │         │                   └ UpdateCar(id=5, car_number='13123', model='123', owner='0', odometer=0.0, picture=None)
                │         └ <function update_car at 0x7fbc46dcef70>
                └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 87, in update_car
    db.commit()
    │  └ <function Session.commit at 0x7fbc46ff0310>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc436c50a0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
    │    │            │               │    └ False
    │    │            │               └ <sqlalchemy.orm.session.Session object at 0x7fbc436c50a0>
    │    │            └ <function SessionTransaction.commit at 0x7fbc46fed280>
    │    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc447b0700>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc436c50a0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x7fbc46fed1f0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc447b0700>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x7fbc46feff70>
    │    └ <sqlalchemy.orm.session.Session object at 0x7fbc436c50a0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc447b0700>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3386, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7fbc46ff3160>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc436c50a0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3526, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x7fbc46fed310>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43448e80>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util.compat' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3486, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7fbc46fe5940>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc434489a0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc434489a0>
    │   └ <function SaveUpdateAll.execute at 0x7fbc46fe7280>
    └ SaveUpdateAll(mapped class Car->car)
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x7fbc46fd73a0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py'>
    │    └ <sqlalchemy.util._preloaded._ModuleRegistry object at 0x7fbc47e5c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 237, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x7fbc46fd7940>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 1001, in _emit_update_statements
    c = connection._execute_20(
        │          └ <function Connection._execute_20 at 0x7fbc4754bf70>
        └ <sqlalchemy.engine.base.Connection object at 0x7fbc43448fd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ {'compiled_cache': {(<sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>, ('0', <class 'sql...
           │    │     │             └ immutabledict({})
           │    │     └ ([{'car_number': '13123', 'model': '123', 'car_id': 5}],)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43448fd0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x7fbc437112e0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fbc4754bdc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fbc43448fd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fbc4754c0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fbc43448fd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fbc4754c280>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43448fd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43448fd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'model': '123', 'car_id': 5}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s, model=%(model)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4a90; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.

[SQL: UPDATE car SET car_number=%(car_number)s, model=%(model)s WHERE car.id = %(car_id)s]
[parameters: {'car_number': '13123', 'model': '123', 'car_id': 5}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-09-21T14:40:38.683338+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:40:38.683338+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:40:38.697654+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:40:38.697654+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:42:10.006816+0000: INFO|	 GET /api/car/5/ 200 OK
2022-09-21T14:42:10.006816+0000: INFO|	 GET /api/car/5/ 200 OK
2022-09-21T14:42:10.020173+0000: INFO|	 GET /api/car/5/ 200 OK
2022-09-21T14:42:10.020173+0000: INFO|	 GET /api/car/5/ 200 OK
2022-09-21T14:42:11.012110+0000: INFO|	 DELETE /api/car/5/ 200 OK
2022-09-21T14:42:11.012110+0000: INFO|	 DELETE /api/car/5/ 200 OK
2022-09-21T14:42:11.117121+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:42:11.117121+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:42:11.129076+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:42:11.129076+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:42:13.450614+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T14:42:13.450614+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T14:42:13.715801+0000: INFO|	 GET /api/car/6/ 200 OK
2022-09-21T14:42:13.715801+0000: INFO|	 GET /api/car/6/ 200 OK
2022-09-21T14:42:13.727047+0000: INFO|	 GET /api/car/6/ 200 OK
2022-09-21T14:42:13.727047+0000: INFO|	 GET /api/car/6/ 200 OK
2022-09-21T14:42:17.581434+0000: INFO|	 UPDATE /api/car/{ id : 6, car_number : 432141, model : 214124, owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T14:42:17.581434+0000: INFO|	 UPDATE /api/car/{ id : 6, car_number : 432141, model : 214124, owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T14:42:18.785126+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:42:18.785126+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:42:18.800015+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:42:18.800015+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:43:24.336218+0000: INFO|	 GET /api/car/1/ 200 OK
2022-09-21T14:43:24.336218+0000: INFO|	 GET /api/car/1/ 200 OK
2022-09-21T14:43:24.343346+0000: INFO|	 GET /api/car/1/ 200 OK
2022-09-21T14:43:24.343346+0000: INFO|	 GET /api/car/1/ 200 OK
2022-09-21T14:43:28.116158+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:43:28.116158+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:43:28.130058+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:43:28.130058+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:43:37.400088+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T14:43:37.400088+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T14:43:37.414228+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T14:43:37.414228+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T14:43:43.199742+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140446663046976):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43460d30>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 4}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4b80; closed: -1>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 159, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7fbc495689d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7fbc47e9ae50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7fbc47e9a940>
    └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fbc47e9a9d0>
           │       │   └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
           │       └ <function run at 0x7fbc494749d0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7fbc44918340>
           │    └ <function BaseEventLoop.run_until_complete at 0x7fbc48dd10d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7fbc48dd1040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7fbc48dd2b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7fbc48e07820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434606a0>(<Future finis...7fbc436f2c40>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434606a0>(<Future finis...7fbc436f2c40>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434606a0>(<Future finis...7fbc436f2c40>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434606a0>(<Future finis...7fbc436f2c40>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
          └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc436d2040>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc436d2040>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7fbc47f6b160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7fbc4474ec10>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7fbc48077280>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7fbc448a20d0>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fbc4488e6d0>
                     └ <function get_request_handler.<locals>.app at 0x7fbc448a2040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fbc48065160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7fbc436f2c40>, 'car_data': UpdateCar(id=4, car_number='13123', model='4214...
                 │         └ <function update_car at 0x7fbc448b0f70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7fbc448a8310>

  File "/app/fastapi_service/main.py", line 152, in update_car
    car = await _services.update_car(car_data=car_data, car=car, db=db)
                │         │                   │             │       └ <sqlalchemy.orm.session.Session object at 0x7fbc436f2c40>
                │         │                   │             └ <models.Car object at 0x7fbc43460a60>
                │         │                   └ UpdateCar(id=4, car_number='13123', model='4214', owner='0', odometer=0.0, picture=None)
                │         └ <function update_car at 0x7fbc46dcef70>
                └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 87, in update_car
    db.commit()
    │  └ <function Session.commit at 0x7fbc46ff0310>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc436f2c40>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
    │    │            │               │    └ False
    │    │            │               └ <sqlalchemy.orm.session.Session object at 0x7fbc436f2c40>
    │    │            └ <function SessionTransaction.commit at 0x7fbc46fed280>
    │    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc434602e0>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc436f2c40>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x7fbc46fed1f0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc434602e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x7fbc46feff70>
    │    └ <sqlalchemy.orm.session.Session object at 0x7fbc436f2c40>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc434602e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3386, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7fbc46ff3160>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc436f2c40>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3526, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x7fbc46fed310>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43460190>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util.compat' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3486, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7fbc46fe5940>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc436f2850>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc436f2850>
    │   └ <function SaveUpdateAll.execute at 0x7fbc46fe7280>
    └ SaveUpdateAll(mapped class Car->car)
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x7fbc46fd73a0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py'>
    │    └ <sqlalchemy.util._preloaded._ModuleRegistry object at 0x7fbc47e5c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 237, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x7fbc46fd7940>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 1001, in _emit_update_statements
    c = connection._execute_20(
        │          └ <function Connection._execute_20 at 0x7fbc4754bf70>
        └ <sqlalchemy.engine.base.Connection object at 0x7fbc43460d30>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ {'compiled_cache': {(<sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>, ('0', <class 'sql...
           │    │     │             └ immutabledict({})
           │    │     └ ([{'car_number': '13123', 'car_id': 4}],)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43460d30>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x7fbc437112e0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fbc4754bdc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fbc43460d30>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fbc4754c0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fbc43460d30>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fbc4754c280>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43460d30>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43460d30>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 4}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4b80; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.

[SQL: UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s]
[parameters: {'car_number': '13123', 'car_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-09-21T14:43:43.199742+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140446663046976):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43460d30>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 4}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4b80; closed: -1>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 159, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7fbc495689d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7fbc47e9ae50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7fbc47e9a940>
    └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fbc47e9a9d0>
           │       │   └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
           │       └ <function run at 0x7fbc494749d0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7fbc44918340>
           │    └ <function BaseEventLoop.run_until_complete at 0x7fbc48dd10d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7fbc48dd1040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7fbc48dd2b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7fbc48e07820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434606a0>(<Future finis...7fbc436f2c40>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434606a0>(<Future finis...7fbc436f2c40>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434606a0>(<Future finis...7fbc436f2c40>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc434606a0>(<Future finis...7fbc436f2c40>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
          └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc436d2040>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc436d2040>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7fbc47f6b160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7fbc4474ec10>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7fbc48077280>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4370dca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc43460ac0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7fbc448a20d0>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fbc4488e6d0>
                     └ <function get_request_handler.<locals>.app at 0x7fbc448a2040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fbc48065160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7fbc436f2c40>, 'car_data': UpdateCar(id=4, car_number='13123', model='4214...
                 │         └ <function update_car at 0x7fbc448b0f70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7fbc448a8310>

  File "/app/fastapi_service/main.py", line 152, in update_car
    car = await _services.update_car(car_data=car_data, car=car, db=db)
                │         │                   │             │       └ <sqlalchemy.orm.session.Session object at 0x7fbc436f2c40>
                │         │                   │             └ <models.Car object at 0x7fbc43460a60>
                │         │                   └ UpdateCar(id=4, car_number='13123', model='4214', owner='0', odometer=0.0, picture=None)
                │         └ <function update_car at 0x7fbc46dcef70>
                └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 87, in update_car
    db.commit()
    │  └ <function Session.commit at 0x7fbc46ff0310>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc436f2c40>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
    │    │            │               │    └ False
    │    │            │               └ <sqlalchemy.orm.session.Session object at 0x7fbc436f2c40>
    │    │            └ <function SessionTransaction.commit at 0x7fbc46fed280>
    │    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc434602e0>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc436f2c40>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x7fbc46fed1f0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc434602e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x7fbc46feff70>
    │    └ <sqlalchemy.orm.session.Session object at 0x7fbc436f2c40>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc434602e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3386, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7fbc46ff3160>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc436f2c40>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3526, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x7fbc46fed310>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43460190>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util.compat' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3486, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7fbc46fe5940>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc436f2850>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc436f2850>
    │   └ <function SaveUpdateAll.execute at 0x7fbc46fe7280>
    └ SaveUpdateAll(mapped class Car->car)
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x7fbc46fd73a0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py'>
    │    └ <sqlalchemy.util._preloaded._ModuleRegistry object at 0x7fbc47e5c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 237, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x7fbc46fd7940>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 1001, in _emit_update_statements
    c = connection._execute_20(
        │          └ <function Connection._execute_20 at 0x7fbc4754bf70>
        └ <sqlalchemy.engine.base.Connection object at 0x7fbc43460d30>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ {'compiled_cache': {(<sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>, ('0', <class 'sql...
           │    │     │             └ immutabledict({})
           │    │     └ ([{'car_number': '13123', 'car_id': 4}],)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43460d30>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x7fbc437112e0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fbc4754bdc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fbc43460d30>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fbc4754c0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fbc43460d30>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fbc4754c280>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43460d30>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc43460d30>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 4}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4b80; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.

[SQL: UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s]
[parameters: {'car_number': '13123', 'car_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-09-21T14:43:44.772923+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:43:44.772923+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:43:44.784571+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:43:44.784571+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:43:50.265422+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T14:43:50.265422+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T14:43:50.278440+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T14:43:50.278440+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T14:43:55.938533+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140446663046976):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc434608e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 4}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4c70; closed: -1>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 159, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7fbc495689d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7fbc47e9ae50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7fbc47e9a940>
    └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fbc47e9a9d0>
           │       │   └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
           │       └ <function run at 0x7fbc494749d0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7fbc44918340>
           │    └ <function BaseEventLoop.run_until_complete at 0x7fbc48dd10d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7fbc48dd1040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7fbc48dd2b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7fbc48e07820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc437118e0>(<Future finis...7fbc43460280>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7fbc437118e0>(<Future finis...7fbc43460280>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7fbc437118e0>(<Future finis...7fbc43460280>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc437118e0>(<Future finis...7fbc43460280>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
          └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc4344ed30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc4344ed30>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7fbc47f6b160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344ec10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344ec10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7fbc4474ec10>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344ec10>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7fbc48077280>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344ec10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7fbc448a20d0>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fbc43460f10>
                     └ <function get_request_handler.<locals>.app at 0x7fbc448a2040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fbc48065160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7fbc43460280>, 'car_data': UpdateCar(id=4, car_number='13123', model='4214...
                 │         └ <function update_car at 0x7fbc448b0f70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7fbc448a8310>

  File "/app/fastapi_service/main.py", line 152, in update_car
    car = await _services.update_car(car_data=car_data, car=car, db=db)
                │         │                   │             │       └ <sqlalchemy.orm.session.Session object at 0x7fbc43460280>
                │         │                   │             └ <models.Car object at 0x7fbc43453fd0>
                │         │                   └ UpdateCar(id=4, car_number='13123', model='4214', owner='0', odometer=0.0, picture=None)
                │         └ <function update_car at 0x7fbc46dcef70>
                └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 87, in update_car
    db.commit()
    │  └ <function Session.commit at 0x7fbc46ff0310>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc43460280>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
    │    │            │               │    └ False
    │    │            │               └ <sqlalchemy.orm.session.Session object at 0x7fbc43460280>
    │    │            └ <function SessionTransaction.commit at 0x7fbc46fed280>
    │    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43460a60>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc43460280>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x7fbc46fed1f0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43460a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x7fbc46feff70>
    │    └ <sqlalchemy.orm.session.Session object at 0x7fbc43460280>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43460a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3386, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7fbc46ff3160>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc43460280>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3526, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x7fbc46fed310>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43460f70>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util.compat' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3486, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7fbc46fe5940>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc448a8ee0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc448a8ee0>
    │   └ <function SaveUpdateAll.execute at 0x7fbc46fe7280>
    └ SaveUpdateAll(mapped class Car->car)
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x7fbc46fd73a0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py'>
    │    └ <sqlalchemy.util._preloaded._ModuleRegistry object at 0x7fbc47e5c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 237, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x7fbc46fd7940>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 1001, in _emit_update_statements
    c = connection._execute_20(
        │          └ <function Connection._execute_20 at 0x7fbc4754bf70>
        └ <sqlalchemy.engine.base.Connection object at 0x7fbc434608e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ {'compiled_cache': {(<sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>, ('0', <class 'sql...
           │    │     │             └ immutabledict({})
           │    │     └ ([{'car_number': '13123', 'car_id': 4}],)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fbc434608e0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x7fbc437112e0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fbc4754bdc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fbc434608e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fbc4754c0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fbc434608e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fbc4754c280>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc434608e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc434608e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 4}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4c70; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.

[SQL: UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s]
[parameters: {'car_number': '13123', 'car_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-09-21T14:43:55.938533+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140446663046976):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc434608e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 4}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4c70; closed: -1>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 159, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7fbc495689d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7fbc47e9ae50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7fbc47e9a940>
    └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fbc47e9a9d0>
           │       │   └ <uvicorn.server.Server object at 0x7fbc4473cfa0>
           │       └ <function run at 0x7fbc494749d0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7fbc44918340>
           │    └ <function BaseEventLoop.run_until_complete at 0x7fbc48dd10d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7fbc48dd1040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7fbc48dd2b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7fbc48e07820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc437118e0>(<Future finis...7fbc43460280>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7fbc437118e0>(<Future finis...7fbc43460280>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7fbc437118e0>(<Future finis...7fbc43460280>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fbc437118e0>(<Future finis...7fbc43460280>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fbc46dd9070>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
          └ <fastapi.applications.FastAPI object at 0x7fbc4474eb50>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc4344ed30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fbc4475b8e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fbc4344ed30>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7fbc47f6b160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fbc4475b880>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344ec10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fbc4475b850>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344ec10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7fbc4474ec10>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fbc4475b7f0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344ec10>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7fbc48077280>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fbc4344ec10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fbc434538e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7fbc448a20d0>
          └ <fastapi.routing.APIRoute object at 0x7fbc448a82e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fbc43460f10>
                     └ <function get_request_handler.<locals>.app at 0x7fbc448a2040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fbc48065160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7fbc43460280>, 'car_data': UpdateCar(id=4, car_number='13123', model='4214...
                 │         └ <function update_car at 0x7fbc448b0f70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7fbc448a8310>

  File "/app/fastapi_service/main.py", line 152, in update_car
    car = await _services.update_car(car_data=car_data, car=car, db=db)
                │         │                   │             │       └ <sqlalchemy.orm.session.Session object at 0x7fbc43460280>
                │         │                   │             └ <models.Car object at 0x7fbc43453fd0>
                │         │                   └ UpdateCar(id=4, car_number='13123', model='4214', owner='0', odometer=0.0, picture=None)
                │         └ <function update_car at 0x7fbc46dcef70>
                └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 87, in update_car
    db.commit()
    │  └ <function Session.commit at 0x7fbc46ff0310>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc43460280>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
    │    │            │               │    └ False
    │    │            │               └ <sqlalchemy.orm.session.Session object at 0x7fbc43460280>
    │    │            └ <function SessionTransaction.commit at 0x7fbc46fed280>
    │    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43460a60>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc43460280>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x7fbc46fed1f0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43460a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x7fbc46feff70>
    │    └ <sqlalchemy.orm.session.Session object at 0x7fbc43460280>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43460a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3386, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7fbc46ff3160>
    └ <sqlalchemy.orm.session.Session object at 0x7fbc43460280>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3526, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x7fbc46fed310>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7fbc43460f70>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util.compat' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3486, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7fbc46fe5940>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc448a8ee0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7fbc448a8ee0>
    │   └ <function SaveUpdateAll.execute at 0x7fbc46fe7280>
    └ SaveUpdateAll(mapped class Car->car)
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x7fbc46fd73a0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py'>
    │    └ <sqlalchemy.util._preloaded._ModuleRegistry object at 0x7fbc47e5c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 237, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x7fbc46fd7940>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 1001, in _emit_update_statements
    c = connection._execute_20(
        │          └ <function Connection._execute_20 at 0x7fbc4754bf70>
        └ <sqlalchemy.engine.base.Connection object at 0x7fbc434608e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ {'compiled_cache': {(<sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>, ('0', <class 'sql...
           │    │     │             └ immutabledict({})
           │    │     └ ([{'car_number': '13123', 'car_id': 4}],)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fbc434608e0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x7fbc437112e0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fbc4754bdc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fbc434608e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fbc4754c0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fbc434608e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fbc4754c280>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc434608e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fbc47d9c040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fbc48a43c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fbc46e0e100>
    └ <sqlalchemy.engine.base.Connection object at 0x7fbc434608e0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '13123', 'car_id': 4}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fbc448a4c70; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(13123) already exists.

[SQL: UPDATE car SET car_number=%(car_number)s WHERE car.id = %(car_id)s]
[parameters: {'car_number': '13123', 'car_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-09-21T14:43:57.275503+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:43:57.275503+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:43:57.289976+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T14:43:57.289976+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:02:21.387360+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:02:21.387360+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:02:21.401135+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:02:21.401135+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:02:22.403059+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:02:22.403059+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:03:39.043065+0000: INFO|	 POST /api/car/ { car_number : 13123, model : string, owner : string, odometer : 0.0, picture : string } 200 OK
2022-09-21T15:03:39.043065+0000: INFO|	 POST /api/car/ { car_number : 13123, model : string, owner : string, odometer : 0.0, picture : string } 200 OK
2022-09-21T15:03:43.888124+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:03:43.888124+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:03:43.904154+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:03:43.904154+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:03:45.138633+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:03:45.138633+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:03:45.613158+0000: INFO|	 GET /api/car/?page=2&per_page=10/ 200 OK
2022-09-21T15:03:45.613158+0000: INFO|	 GET /api/car/?page=2&per_page=10/ 200 OK
2022-09-21T15:12:11.609978+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:12:11.609978+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:12:11.625385+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:12:11.625385+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:12:12.464620+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:12:12.464620+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:12:13.600529+0000: INFO|	 GET /api/car/?page=2&per_page=10/ 200 OK
2022-09-21T15:12:13.600529+0000: INFO|	 GET /api/car/?page=2&per_page=10/ 200 OK
2022-09-21T15:12:14.686386+0000: INFO|	 GET /api/car/?page=3&per_page=10/ 200 OK
2022-09-21T15:12:14.686386+0000: INFO|	 GET /api/car/?page=3&per_page=10/ 200 OK
2022-09-21T15:12:40.069731+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T15:12:40.069731+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T15:12:40.077949+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T15:12:40.077949+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T15:12:48.403741+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:12:48.403741+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:12:48.417154+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:12:48.417154+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:13:16.110913+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:13:16.110913+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:13:16.132908+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:13:16.132908+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:13:26.090832+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T15:13:26.090832+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T15:13:26.100799+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T15:13:26.100799+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T15:13:30.570486+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:13:30.570486+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:13:30.579561+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:13:30.579561+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:13:39.332799+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:13:39.332799+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:13:39.397676+0000: INFO|	 GET /api/car/?page=2&per_page=10/ 200 OK
2022-09-21T15:13:39.397676+0000: INFO|	 GET /api/car/?page=2&per_page=10/ 200 OK
2022-09-21T15:13:44.568525+0000: INFO|	 GET /api/car/?page=3&per_page=10/ 200 OK
2022-09-21T15:13:44.568525+0000: INFO|	 GET /api/car/?page=3&per_page=10/ 200 OK
2022-09-21T15:13:47.989813+0000: INFO|	 GET /api/car/?page=4&per_page=10/ 200 OK
2022-09-21T15:13:47.989813+0000: INFO|	 GET /api/car/?page=4&per_page=10/ 200 OK
2022-09-21T15:13:49.843740+0000: INFO|	 GET /api/car/?page=5&per_page=10/ 200 OK
2022-09-21T15:13:49.843740+0000: INFO|	 GET /api/car/?page=5&per_page=10/ 200 OK
2022-09-21T15:13:50.923613+0000: INFO|	 GET /api/car/?page=6&per_page=10/ 200 OK
2022-09-21T15:13:50.923613+0000: INFO|	 GET /api/car/?page=6&per_page=10/ 200 OK
2022-09-21T15:13:53.843080+0000: INFO|	 GET /api/car/?page=7&per_page=10/ 200 OK
2022-09-21T15:13:53.843080+0000: INFO|	 GET /api/car/?page=7&per_page=10/ 200 OK
2022-09-21T15:13:53.851758+0000: INFO|	 GET /api/car/?page=7&per_page=10/ 200 OK
2022-09-21T15:13:53.851758+0000: INFO|	 GET /api/car/?page=7&per_page=10/ 200 OK
2022-09-21T15:13:53.883277+0000: INFO|	 GET /api/car/?page=8&per_page=10/ 200 OK
2022-09-21T15:13:53.883277+0000: INFO|	 GET /api/car/?page=8&per_page=10/ 200 OK
2022-09-21T15:13:55.565648+0000: INFO|	 GET /api/car/?page=9&per_page=10/ 200 OK
2022-09-21T15:13:55.565648+0000: INFO|	 GET /api/car/?page=9&per_page=10/ 200 OK
2022-09-21T15:13:56.996748+0000: INFO|	 GET /api/car/?page=10&per_page=10/ 200 OK
2022-09-21T15:13:56.996748+0000: INFO|	 GET /api/car/?page=10&per_page=10/ 200 OK
2022-09-21T15:14:58.193544+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:14:58.193544+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:14:58.578305+0000: INFO|	 GET /api/car/?page=2&per_page=10/ 200 OK
2022-09-21T15:14:58.578305+0000: INFO|	 GET /api/car/?page=2&per_page=10/ 200 OK
2022-09-21T15:17:07.094487+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:17:07.094487+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:17:07.119571+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:17:07.119571+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:17:07.218110+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:17:07.218110+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:17:23.832631+0000: INFO|	 GET /api/car/ { id : None, car_number : None, model : string, owner : None, odometer : None, picture : None } 200 OK
2022-09-21T15:17:23.832631+0000: INFO|	 GET /api/car/ { id : None, car_number : None, model : string, owner : None, odometer : None, picture : None } 200 OK
2022-09-21T15:22:42.490305+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:22:42.490305+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:22:42.500760+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:22:42.500760+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:22:44.312464+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T15:22:44.312464+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T15:22:44.356999+0000: INFO|	 GET /api/car/7/ 200 OK
2022-09-21T15:22:44.356999+0000: INFO|	 GET /api/car/7/ 200 OK
2022-09-21T15:22:44.563415+0000: INFO|	 GET /api/car/7/ 200 OK
2022-09-21T15:22:44.563415+0000: INFO|	 GET /api/car/7/ 200 OK
2022-09-21T15:23:29.063133+0000: INFO|	 UPDATE /api/car/{ id : 7, car_number : 3123, model : 2131, owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T15:23:29.063133+0000: INFO|	 UPDATE /api/car/{ id : 7, car_number : 3123, model : 2131, owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T15:23:32.804360+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:23:32.804360+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:23:32.818399+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:23:32.818399+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:23:34.489794+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:23:34.489794+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:23:35.289533+0000: INFO|	 GET /api/car/?page=2&per_page=10/ 200 OK
2022-09-21T15:23:35.289533+0000: INFO|	 GET /api/car/?page=2&per_page=10/ 200 OK
2022-09-21T15:23:37.622223+0000: INFO|	 GET /api/car/?page=3&per_page=10/ 200 OK
2022-09-21T15:23:37.622223+0000: INFO|	 GET /api/car/?page=3&per_page=10/ 200 OK
2022-09-21T15:23:42.127579+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T15:23:42.127579+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T15:23:42.179773+0000: INFO|	 GET /api/car/8/ 200 OK
2022-09-21T15:23:42.179773+0000: INFO|	 GET /api/car/8/ 200 OK
2022-09-21T15:23:42.311188+0000: INFO|	 GET /api/car/8/ 200 OK
2022-09-21T15:23:42.311188+0000: INFO|	 GET /api/car/8/ 200 OK
2022-09-21T15:23:59.324770+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140092300425024):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f69c6fbbc10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f69c5473ca0>
    └ <sqlalchemy.engine.base.Connection object at 0x7f69c2461cd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '3123', 'model': 'new', 'car_id': 8}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s, model=%(model)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f69c2d1d9a0; closed: -1>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(3123) already exists.



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 159, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f69c7ae09d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f69c6411e50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f69c6411940>
    └ <uvicorn.server.Server object at 0x7f69c2dcea00>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f69c64119d0>
           │       │   └ <uvicorn.server.Server object at 0x7f69c2dcea00>
           │       └ <function run at 0x7f69c79ec9d0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f69c2dc6140>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f69c73490d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f69c7349040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f69c734ab80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f69c737f820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f69c2d1f730>(<Future finis...7f69c2cda370>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f69c2d1f730>(<Future finis...7f69c2cda370>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f69c2d1f730>(<Future finis...7f69c2cda370>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f69c2d1f730>(<Future finis...7f69c2cda370>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f69c2d60220>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f69c2dce790>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f69c2d60220>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f69c2d7e0d0>
          └ <fastapi.applications.FastAPI object at 0x7f69c2dce790>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f69c2d77550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f69c2d7e070>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f69c2d7e0d0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f69c2d77550>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7f69c64e3160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f69c2d7e070>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7f69c2d7e070>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f69c2d7e040>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f69c2d7e070>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f69c2d57310>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f69c2d6ffa0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f69c2d7e040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f69c2d57310>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f69c2d6f580>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f69c2d6ffa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f69c2d57310>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f69c65ee280>
          └ <fastapi.routing.APIRoute object at 0x7f69c2d17a90>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f69c2d57310>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f69c2d18160>
          └ <fastapi.routing.APIRoute object at 0x7f69c2d17a90>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f69c24acb50>
                     └ <function get_request_handler.<locals>.app at 0x7f69c2d180d0>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f69c65db160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f69c2cda370>, 'car_data': UpdateCar(id=8, car_number='3123', model='new',...
                 │         └ <function update_car at 0x7f69c2d18040>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f69c2d17ac0>

  File "/app/fastapi_service/main.py", line 152, in update_car
    car = await _services.update_car(car_data=car_data, car=car, db=db)
                │         │                   │             │       └ <sqlalchemy.orm.session.Session object at 0x7f69c2cda370>
                │         │                   │             └ <models.Car object at 0x7f69c2461f70>
                │         │                   └ UpdateCar(id=8, car_number='3123', model='new', owner='0', odometer=0.0, picture=None)
                │         └ <function update_car at 0x7f69c2e73820>
                └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 87, in update_car
    db.commit()
    │  └ <function Session.commit at 0x7f69c5566310>
    └ <sqlalchemy.orm.session.Session object at 0x7f69c2cda370>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
    │    │            │               │    └ False
    │    │            │               └ <sqlalchemy.orm.session.Session object at 0x7f69c2cda370>
    │    │            └ <function SessionTransaction.commit at 0x7f69c5563280>
    │    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f69c2461040>
    └ <sqlalchemy.orm.session.Session object at 0x7f69c2cda370>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x7f69c55631f0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f69c2461040>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x7f69c5568f70>
    │    └ <sqlalchemy.orm.session.Session object at 0x7f69c2cda370>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f69c2461040>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3386, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7f69c5565160>
    └ <sqlalchemy.orm.session.Session object at 0x7f69c2cda370>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3526, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x7f69c5563310>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f69c2461f40>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x7f69c62fc040>
    └ <module 'sqlalchemy.util.compat' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3486, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7f69c555b940>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7f69c2cf08b0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7f69c2cf08b0>
    │   └ <function SaveUpdateAll.execute at 0x7f69c555e280>
    └ SaveUpdateAll(mapped class Car->car)
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x7f69c554d3a0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py'>
    │    └ <sqlalchemy.util._preloaded._ModuleRegistry object at 0x7f69c6371dc0>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 237, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x7f69c554d940>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 1001, in _emit_update_statements
    c = connection._execute_20(
        │          └ <function Connection._execute_20 at 0x7f69c5ac2f70>
        └ <sqlalchemy.engine.base.Connection object at 0x7f69c2461cd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ {'compiled_cache': {(<sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f69c5473ca0>, ('0', <class 'sql...
           │    │     │             └ immutabledict({})
           │    │     └ ([{'model': 'new', 'car_number': '3123', 'car_id': 8}],)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f69c2461cd0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x7f69c24ac340>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f69c5ac2dc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7f69c2461cd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f69c5ac40d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7f69c2461cd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f69c5ac4280>
    └ <sqlalchemy.engine.base.Connection object at 0x7f69c2461cd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f69c62fc040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f69c6fbbc10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f69c5473ca0>
    └ <sqlalchemy.engine.base.Connection object at 0x7f69c2461cd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '3123', 'model': 'new', 'car_id': 8}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s, model=%(model)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f69c2d1d9a0; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(3123) already exists.

[SQL: UPDATE car SET car_number=%(car_number)s, model=%(model)s WHERE car.id = %(car_id)s]
[parameters: {'car_number': '3123', 'model': 'new', 'car_id': 8}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-09-21T15:23:59.324770+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140092300425024):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f69c6fbbc10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f69c5473ca0>
    └ <sqlalchemy.engine.base.Connection object at 0x7f69c2461cd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '3123', 'model': 'new', 'car_id': 8}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s, model=%(model)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f69c2d1d9a0; closed: -1>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(3123) already exists.



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 159, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f69c7ae09d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f69c6411e50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f69c6411940>
    └ <uvicorn.server.Server object at 0x7f69c2dcea00>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f69c64119d0>
           │       │   └ <uvicorn.server.Server object at 0x7f69c2dcea00>
           │       └ <function run at 0x7f69c79ec9d0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f69c2dc6140>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f69c73490d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f69c7349040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f69c734ab80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f69c737f820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f69c2d1f730>(<Future finis...7f69c2cda370>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f69c2d1f730>(<Future finis...7f69c2cda370>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f69c2d1f730>(<Future finis...7f69c2cda370>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f69c2d1f730>(<Future finis...7f69c2cda370>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f69c2d60220>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f69c2dce790>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f69c2d60220>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f69c2d7e0d0>
          └ <fastapi.applications.FastAPI object at 0x7f69c2dce790>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f69c2d77550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f69c2d7e070>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f69c2d7e0d0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f69c2d77550>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7f69c64e3160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f69c2d7e070>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7f69c2d7e070>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f69c2d7e040>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f69c2d7e070>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f69c2d57310>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f69c2d6ffa0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f69c2d7e040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f69c2d57310>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f69c2d6f580>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f69c2d6ffa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f69c2d57310>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f69c65ee280>
          └ <fastapi.routing.APIRoute object at 0x7f69c2d17a90>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f69c2d57310>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f69c2d1f4c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f69c2d18160>
          └ <fastapi.routing.APIRoute object at 0x7f69c2d17a90>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f69c24acb50>
                     └ <function get_request_handler.<locals>.app at 0x7f69c2d180d0>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f69c65db160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f69c2cda370>, 'car_data': UpdateCar(id=8, car_number='3123', model='new',...
                 │         └ <function update_car at 0x7f69c2d18040>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f69c2d17ac0>

  File "/app/fastapi_service/main.py", line 152, in update_car
    car = await _services.update_car(car_data=car_data, car=car, db=db)
                │         │                   │             │       └ <sqlalchemy.orm.session.Session object at 0x7f69c2cda370>
                │         │                   │             └ <models.Car object at 0x7f69c2461f70>
                │         │                   └ UpdateCar(id=8, car_number='3123', model='new', owner='0', odometer=0.0, picture=None)
                │         └ <function update_car at 0x7f69c2e73820>
                └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 87, in update_car
    db.commit()
    │  └ <function Session.commit at 0x7f69c5566310>
    └ <sqlalchemy.orm.session.Session object at 0x7f69c2cda370>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
    │    │            │               │    └ False
    │    │            │               └ <sqlalchemy.orm.session.Session object at 0x7f69c2cda370>
    │    │            └ <function SessionTransaction.commit at 0x7f69c5563280>
    │    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f69c2461040>
    └ <sqlalchemy.orm.session.Session object at 0x7f69c2cda370>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x7f69c55631f0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f69c2461040>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x7f69c5568f70>
    │    └ <sqlalchemy.orm.session.Session object at 0x7f69c2cda370>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f69c2461040>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3386, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7f69c5565160>
    └ <sqlalchemy.orm.session.Session object at 0x7f69c2cda370>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3526, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x7f69c5563310>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f69c2461f40>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x7f69c62fc040>
    └ <module 'sqlalchemy.util.compat' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3486, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7f69c555b940>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7f69c2cf08b0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7f69c2cf08b0>
    │   └ <function SaveUpdateAll.execute at 0x7f69c555e280>
    └ SaveUpdateAll(mapped class Car->car)
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x7f69c554d3a0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py'>
    │    └ <sqlalchemy.util._preloaded._ModuleRegistry object at 0x7f69c6371dc0>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 237, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x7f69c554d940>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 1001, in _emit_update_statements
    c = connection._execute_20(
        │          └ <function Connection._execute_20 at 0x7f69c5ac2f70>
        └ <sqlalchemy.engine.base.Connection object at 0x7f69c2461cd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ {'compiled_cache': {(<sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f69c5473ca0>, ('0', <class 'sql...
           │    │     │             └ immutabledict({})
           │    │     └ ([{'model': 'new', 'car_number': '3123', 'car_id': 8}],)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f69c2461cd0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x7f69c24ac340>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f69c5ac2dc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7f69c2461cd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f69c5ac40d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7f69c2461cd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f69c5ac4280>
    └ <sqlalchemy.engine.base.Connection object at 0x7f69c2461cd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f69c62fc040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f69c6fbbc10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f69c5473ca0>
    └ <sqlalchemy.engine.base.Connection object at 0x7f69c2461cd0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'car_number': '3123', 'model': 'new', 'car_id': 8}
    │      │       └ 'UPDATE car SET car_number=%(car_number)s, model=%(model)s WHERE car.id = %(car_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f69c2d1d9a0; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "car_car_number_key"
DETAIL:  Key (car_number)=(3123) already exists.

[SQL: UPDATE car SET car_number=%(car_number)s, model=%(model)s WHERE car.id = %(car_id)s]
[parameters: {'car_number': '3123', 'model': 'new', 'car_id': 8}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-09-21T15:24:00.906753+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:24:00.906753+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:24:00.917178+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:24:00.917178+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:24:01.723588+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:24:01.723588+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T15:24:01.986840+0000: INFO|	 GET /api/car/?page=2&per_page=10/ 200 OK
2022-09-21T15:24:01.986840+0000: INFO|	 GET /api/car/?page=2&per_page=10/ 200 OK
2022-09-21T15:43:52.385487+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T15:43:52.385487+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T15:43:52.632302+0000: INFO|	 GET /api/car/8/ 200 OK
2022-09-21T15:43:52.632302+0000: INFO|	 GET /api/car/8/ 200 OK
2022-09-21T15:43:52.643495+0000: INFO|	 GET /api/car/8/ 200 OK
2022-09-21T15:43:52.643495+0000: INFO|	 GET /api/car/8/ 200 OK
2022-09-21T15:43:56.236609+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:43:56.236609+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:43:56.250030+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:43:56.250030+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T15:43:57.537540+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T15:43:57.537540+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T15:43:57.552036+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T15:43:57.552036+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T16:04:27.550476+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T16:04:27.550476+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T16:04:27.574453+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T16:04:27.574453+0000: INFO|	 GET /api/car/4/ 200 OK
2022-09-21T16:04:30.247082+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T16:04:30.247082+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T16:04:30.268590+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T16:04:30.268590+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T16:04:35.201081+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T16:04:35.201081+0000: INFO|	 GET /api/car/?page=1&per_page=10/ 200 OK
2022-09-21T16:04:35.900718+0000: INFO|	 GET /api/car/?page=2&per_page=10/ 200 OK
2022-09-21T16:04:35.900718+0000: INFO|	 GET /api/car/?page=2&per_page=10/ 200 OK
2022-09-21T16:04:46.366355+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T16:04:46.366355+0000: INFO|	 POST /api/car/ { car_number : , model : , owner : 0, odometer : 0.0, picture : None } 200 OK
2022-09-21T16:04:46.479491+0000: INFO|	 GET /api/car/8/ 200 OK
2022-09-21T16:04:46.479491+0000: INFO|	 GET /api/car/8/ 200 OK
2022-09-21T16:04:46.494802+0000: INFO|	 GET /api/car/8/ 200 OK
2022-09-21T16:04:46.494802+0000: INFO|	 GET /api/car/8/ 200 OK
2022-09-21T16:04:55.435768+0000: ERROR|	 UPDATE /api/car/{ id : 8, car_number : 124, model : 21312, owner : 0, odometer : 0.0, picture : None } 409 CAR WITH SUCH NUMBER ALREADY EXISTS
2022-09-21T16:04:55.435768+0000: ERROR|	 UPDATE /api/car/{ id : 8, car_number : 124, model : 21312, owner : 0, odometer : 0.0, picture : None } 409 CAR WITH SUCH NUMBER ALREADY EXISTS
2022-09-21T16:04:56.835846+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T16:04:56.835846+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T16:04:56.854864+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
2022-09-21T16:04:56.854864+0000: INFO|	 GET /api/car/?page=0&per_page=10/ 200 OK
